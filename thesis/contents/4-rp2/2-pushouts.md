## Pushouts {#sec:rp2_pushouts}

As we have seen, higher inductive types allow mimicking CW complexes by using $n$-dimensional paths as $n$-cells. Unfortunately, this is not always possible. For starters, an $n$-path can only connect *two* $(n-1)$-paths, whereas cells can join an arbitrary number of lower dimensional cells.

So the question is raised: how does one build more complex spaces in homotopy type theory?
In classical topology, there are tools like *gluing* (quotient spaces) that allow us to join or collapse spaces in different ways.
In homotopy type theory we need more refined techniques, because we want these to preserve the homotopic invariants we are working with.
In @sec:circle_truncation we have seen a way to do this, parametrizing $1$-types by lower dimensional cells.
As an alternative, more robust method, in this chapter we present the **pushout**.

In category theory, a pushout is a kind of colimit. This roughly means that it is a unique (up to factorization) object out of a diagram. The diagram for a pushout is usually represented as such:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(X\)};
\node (Y) at (2,0) {\(Y\)};
\node (Z) at (0,-2) {\(Z\)};
\draw[->] (X) -- (Y) node[midway,above] {$f$};
\draw[->] (X) -- (Z) node[midway,left] {$g$};
\end{tikzpicture}
\end{center}

In certain categories, there is a pushout of such diagram.

\begin{definition}
The \textbf{pushout} of a diagram $Y \xleftarrow{f} X \xrightarrow{g} Z$ is an object $P$ together with morphisms $Y \xrightarrow{i} P \xleftarrow{j} X$ such that the following diagram commutes:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(X\)};
\node (Y) at (2,0) {\(Y\)};
\node (Z) at (0,-2) {\(Z\)};
\node (P) at (2,-2) {\(P\)};
\draw[->] (X) -- (Y) node[midway,above] {$f$};
\draw[->] (X) -- (Z) node[midway,left] {$g$};
\draw[->] (Y) -- (P) node[midway,right] {$i$};
\draw[->] (Z) -- (P) node[midway,below] {$j$};
\end{tikzpicture}
\end{center}

and such that, for any other such diagram $Y \xrightarrow{i'} P' \xleftarrow{j'} X$, there exists a unique morphism $s : P \rightarrow P'$ such that the full diagram commutes:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(X\)};
\node (Y) at (2,0) {\(Y\)};
\node (Z) at (0,-2) {\(Z\)};
\node (P) at (2,-2) {\(P\)};
\node (P') at (4,-4) {\(P'\)};
\draw[->] (X) -- (Y) node[midway,above] {$f$};
\draw[->] (X) -- (Z) node[midway,left] {$g$};
\draw[->] (Y) -- (P) node[midway,right] {$i$};
\draw[->] (Z) -- (P) node[midway,below] {$j$};
\path[->] (Y) edge[bend left] node[above=5mm]{$i'$} (P');
\path[->] (Z) edge[bend right] node[left=5mm]{$j'$} (P');
\draw[->] (P) -- (P') node[midway,above] {$s$};
\end{tikzpicture}
\end{center}

\end{definition}

This last property is know as the universal property of the pushout, which makes it unique up to isomorphism.

The category \Top of topological spaces is cocomplete, which means that it contains all (set-indexed) colimits, such as pushouts.
The pushout of two topological spaces $Y$ and $Z$ is the space $(Y \sqcup Z)/\sim$, where $\sim$ is the equivalence relationship generated by $\iota_Y(f(x)) \sim \iota_Z(g(x))$ for all $x$ in $X$, and $\iota_Y$, $\iota_Z$ are the inclusion functions.
This can be visualized as "gluing" $Y$ and $Z$ along the points that share a preimage in $X$.

Things get ugly once we step into homotopy theory territory. Homotopy equivalences can be studied from a categorical point of view by taking the homotopy classes of maps as morphisms. The resulting category, known as \HoTop, does *not* have all colimits. In particular, we cannot always build pushouts. A classic example: suppose the diagram $\dtwo \hookleftarrow \sone \hookrightarrow \dtwo$ given by the standard inclusion of the circle into two copies of the closed 2-dimensional disk. The pushout of this diagram is the sphere \stwo, because it is the result of gluing the two disks along their boundaries:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(\sone\)};
\node (Y) at (2,0) {\(\dtwo\)};
\node (Z) at (0,-2) {\(\dtwo\)};
\node (P) at (2,-2) {\(\stwo\)};
\draw[right hook->] (X) -- (Y);
\draw[right hook->] (X) -- (Z);
\draw[right hook->] (Y) -- (P);
\draw[right hook->] (Z) -- (P);
\end{tikzpicture}
\end{center}

One would expect that, in \HoTop, replacing all the spaces by homotopy equivalent ones would result in a homotopy equivalent pushout. This is not the case. For example, as the disk is contractible, it can be replaced with \ast{} (the single-point space), and then the resulting pushout is \ast{} as well:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(\sone\)};
\node (Y) at (2,0) {\(\ast\)};
\node (Z) at (0,-2) {\(\ast\)};
\node (P) at (2,-2) {\(\ast\)};
\draw[->] (X) -- (Y);
\draw[->] (X) -- (Z);
\draw[->] (Y) -- (P);
\draw[->] (Z) -- (P);
\end{tikzpicture}
\end{center}

But \ast{} is not homotopy equivalent to \stwo.

As a fix, mathematicians came up with the **homotopy pushout**.

```\begin{definition}```{=latex}
The **mapping cylinder** of a map $f : X \rightarrow Y$ is the space:

$$M_f = ((X \times [0,1]) \amalg Y)/\sim$$

where $\sim$ is the equivalence relationship generated by $(x,0) \sim f(x) \forall x \in X$, and $\amalg$ represents the disjoint union.
```\end{definition}```{=latex}

```\begin{lemma}```{=latex}
$M_f$ is homotopically equivalent to $Y$.
```\end{lemma}```{=latex}

```\begin{proof}```{=latex}
It is enough to show that $Y$ is a deformation retract of $M_f$.
To do this, we define $F : M_f \times [0,1] \rightarrow M_f$ to be constant on the inclusion of $Y$ into $M_f$, and map $((x,t),s) \in (X \times [0,1]) \times [0,1]$ to $(x,t(1-s))$.
This definition is correct because for $(x,0)$, both parts of the definition concur.
Now, we observe that $F(-,0)$ is the identity of $M_f$, as $t(1-s) = t$ for $s = 0$.
We also see that $F(p,1)$ belongs in $Y$ for any $p \in M_f$, because $F((x,t),1) = (x,0)$, which is identified with $f(x) \in Y$ by $\sim$.
Finally, $F(-,1)$ is the identity function in $Y$, as we have defined $M_f$ to be constant on $Y$.
```\end{proof}```{=latex}

```\begin{lemma}```{=latex}
Given any map $f : X \rightarrow Y$, there exists a map $\tilde{f} : X \rightarrow M_f$ that makes the follow diagram commute:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(X\)};
\node (Mf) at (2,0) {\(M_f\)};
\node (Y) at (2,-1) {\(Y\)};
\draw[->] (X) -- (Mf) node[midway,above]{$\tilde{f}$};
\draw[->] (X) -- (Y) node[midway,below]{$f$};
\draw[->] (Mf) -- (Y) node[midway,right]{$\simeq$};
\end{tikzpicture}
\end{center}

```\end{lemma}```{=latex}

```\begin{proof}```{=latex}
We take $\tilde{f}$ to be $F(-,0) : X \rightarrow M_f$.
```\end{proof}```{=latex}

```\begin{definition}```{=latex} \label{rp2_pushouts_homotopy-pushout}
The **homotopy pushout** of the diagram $Y \xleftarrow{f} X \xrightarrow{g} Z$ is the topological pushout of the diagram $M_f \xleftarrow{\tilde{f}} X \xrightarrow{\tilde{g}} Z$.
```\end{definition}```{=latex}

Equivalently, it is the quotient of $M_f \amalg M_g$ by the relation that identifies each $(x,1)$ in $M_f$ with each $(x,1)$ in $M_g$.
As we are replacing spaces with homotopy equivalent ones, and arrows with homotopic ones, we are respecting the diagram from a categorical point of view.
The homotopy pushout, once defined, *does* respect homotopy types: if we replace any (or all) of $X$, $Y$, or $Z$ with homotopy equivalent objects, then the homotopy pushout will also be homotopy equivalent to the original one.
But, as a tradeoff, the homotopy pushout is *not* a pushout in the homotopy category \HoTop.
This costs us the universal property.
Suppose we have two different commuting squares:

\begin{center}
\begin{tikzpicture}
\node (X) at (0,0) {\(X\)};
\node (Y) at (2,0) {\(Y\)};
\node (Z) at (0,-2) {\(Z\)};
\node (P) at (2,-2) {\(P\)};
\node (P') at (4,-4) {\(P'\)};
\draw[right hook->] (X) -- (Y) node[midway,above]{$f$};
\draw[right hook->] (X) -- (Z) node[midway,left]{$g$};
\draw[->] (Y) -- (P) node[midway,right]{$i$};
\draw[->] (Z) -- (P) node[midway,below]{$j$};
\path[->] (Y) edge[bend left] node[above=5mm]{$i'$} (P');
\path[->] (Z) edge[bend right] node[left=5mm]{$j'$} (P');
\draw[->] (P) -- (P') node[midway,above] {$s$};
\end{tikzpicture}
\end{center}

The arrow $s : P \rightarrow P'$ is not unique up to homotopy, in fact there are infinitely many different choices.
Uniqueness is not completely lost, though, it is only weakened.
In a categorical pushout, the triple $(P',i',j')$, determines a unique $s$.
In a homotopy pushout, we need to add a choice of homotopy $H : i' \circ f \sim j' \circ g$ to that tuple.
Now, given $(P',i',j',H)$, there is only one such $s$.

With all this information, it is now appropriate to introduce the pushout in homotopy type theory.

```\begin{definition}```{=latex} \label{rp2_pushouts_hott-pushout}
A **pushout** of functions $f : X \rightarrow Y$ and $g: X \rightarrow Z$ is a higher inductive type $Y +_X Z$ presented by:

- a function $\inr : Y \rightarrow Y +_X Z$,
- a function $\inl : Z \rightarrow Y +_X Z$, and
- a dependent function $\glue : \prod_{x : X} \inr(f(x)) = \inl(g(x))$.

```\end{definition}```{=latex}

The homotopy type theory pushout retains the idea of "gluing": for each $x$ in $X$, the function \glue gives us a path from $f(x)$ to $g(x)$ (in the pushout type, via the inclusions \inr and \inl). As this definition is type-theoretic, it accepts replacing types with equivalent ones (through the univalence axiom) and preserve the pushout type.

Pushouts allow us to make topological constructions in homotopy type theory. As an example, given a type $A$, one can build its suspension as the pushout of the unique span $\one \leftarrow A \rightarrow \one$. Notice what we obtain:

- a function $\inr : \one \rightarrow \one +_A \one$,
- a function $\inl : \one \rightarrow \one +_A \one$, and
- a dependent function $\glue : \prod_{a : A} \inr(\star) = \inl(\star)$.

\inr and \inl are just inclusions, they do not contribute anything meaningful. But \glue is interesting: instead of literally gluing \one to \one via $A$, we just use $A$ to parametrize the paths, but ignore its points ($a : A$) altogether. The natural functoriality of functions in homotopy type theory will guarantee that the "copy" of $A$ of the suspesion will retain the higher homotopical structure of $A$.

As with any higher inductive type, we can form its elimination principles.
For example, the recursion principle states that, to define a function $s : Y +_X Z \rightarrow D$ into another type $D$, we just have to provide:

- for each $y : Y$, the value of $s(\inr(y)) : D$,
- for each $z : Z$, the value of $s(\inl(z)) : D$, and
- for each $x : X$, the value of $\ap_s(\glue(x)) : s(\inr(f(x))) = s(\inl(g(x)))$.

From this principle, one can deduce a uniqueness principle, which states that given two functions $s, s' : Y +_X Z \rightarrow D$ that coincide on the values above, then $s = s'$.

One may wonder why there is a uniqueness principle in homotopy type theory pushouts but there is none in homotopy pushouts.
The fact is that there actually is, but not in the obvious way.
Observe how, in \cref{rp2_pushouts_hott-pushout} we ask for a homotopy \glue{} between $\inr \circ f$ and $\inl \circ g$.
In the case of the homotopy pushout, this is analogous to the "weakened" uniqueness that also asks for a homotopy $H$.

In the following section we discuss how cells are attached via pushouts.
